<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I came to know about zstd today and I already like it personally. I&rsquo;m never looking back."><title>First time using zstd
</title><link rel="shortcut icon" type=image/x-icon href=/><link rel=stylesheet href=/css/main.08c29b7fac4a11577526584dfb08a52aee38883feba037f71d08cbe4ffde4eaffda104424494fea30b877bcb2969fe832338da1ea7b583435ce50fe3edae4777.css integrity="sha512-CMKbf6xKEVd1JlhN+wilKu44iD/roDf3HQjL5P/eTq/9oQRCRJT+owuHe8spaf6DIzjaHqe1g0Nc5Q/j7a5Hdw=="></head><body a=auto><main class=page-content aria-label=Content><div class=w><a href=/>..</a><article><p class=post-meta><time datetime="2024-11-26 21:50:00 +0530 +0530">2024-11-26</time></p><h1>First time using zstd</h1><aside class=toc><nav id=TableOfContents><ul><li><a href=#zstd>zstd</a></li><li><a href=#tests>Tests</a><ul><li><a href=#environment>Environment</a></li><li><a href=#results>Results</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></aside><h2 id=zstd>zstd</h2><p><a href=https://en.wikipedia.org/wiki/Zstd>zstd / Zstandard</a> is a compression algorithm from Facebook(now Meta) developed by Yann Collet at around ~2015-2016.</p><p>Not gonna lie, but <code>zstd</code> is kinda cool to me.</p><p>Why ?</p><p>Because it is a lot faster than some compression algorithms like <code>gzip</code> while still maintaining the same compression ratio. I kind of feel bad that I only got to know about this today, while skimming through the internet to see how I can reduce the size of the <code>*.tar.gz</code> file that I created. I usually use <code>gzip</code> because I haven&rsquo;t really had a reason to look out for options to be honest.</p><p><code>gzip</code> is based on the <a href=https://en.wikipedia.org/wiki/Deflate>DEFLATE</a> algorithm.</p><h2 id=tests>Tests</h2><p>I&rsquo;ve even done a small test to see which performs better b/w <code>gzip</code> & <code>zstd</code>.</p><h3 id=environment>Environment</h3><p>I used a <code>wsl2</code> environment. I used <a href=https://github.com/BluRosie/hg-engine>hg-engine</a> git repository for testing.</p><p>I had run some builds and other stuff inside this git repository and the total size is around <strong>1.8 GiB</strong>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>du -sh hg-engine/
</span></span><span style=display:flex><span>1.8G    hg-engine/
</span></span></code></pre></div><table><thead><tr><th>System specs</th><th></th></tr></thead><tbody><tr><td><strong>OS</strong></td><td>Debian GNU/Linux bookworm 12.8 x86_64 (WSL2)</td></tr><tr><td><strong>Processor</strong></td><td>AMD Ryzen 5 5600H (12) @ 3.29 GHz</td></tr><tr><td><strong>Ram</strong></td><td>7.43 GiB</td></tr></tbody></table><p>I&rsquo;m going to try and compress this directory by both <code>gzip</code> and <code>zstd</code> using single thread.</p><h3 id=results>Results</h3><table><thead><tr><th>-</th><th style=text-align:center>gzip</th><th style=text-align:center>zstd</th></tr></thead><tbody><tr><td><strong>Size</strong></td><td style=text-align:center>537 MiB</td><td style=text-align:center>300 MiB</td></tr><tr><td><strong>Time</strong></td><td style=text-align:center>56 secs</td><td style=text-align:center>27 secs</td></tr></tbody></table><p><details><summary>Terminal - gzip</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>time tar -I gzip -cf test.tar.gz hg-engine/* <span style=color:#f92672>&amp;&amp;</span> du -sh test.tar.gz
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>real    0m56.044s
</span></span><span style=display:flex><span>user    0m0.002s
</span></span><span style=display:flex><span>sys     0m0.006s
</span></span><span style=display:flex><span>537M    test.tar.gz
</span></span></code></pre></div></details><details><summary>Terminal - zstd</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>time tar -I zstd -cf test.tar.zst hg-engine/* <span style=color:#f92672>&amp;&amp;</span> du -sh test.tar.zst
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>real    0m27.091s
</span></span><span style=display:flex><span>user    0m0.006s
</span></span><span style=display:flex><span>sys     0m0.000s
</span></span><span style=display:flex><span>300M    test.tar.zst
</span></span></code></pre></div></details></p><h2 id=conclusion>Conclusion</h2><p>From this very basic and small test, you could see that <code>zstd</code> performed extremely well in terms of both the size of the final compressed file and the time taken to compress.</p><p>I know that I should have tested this more thoroughly like,</p><ul><li>Multiple threads</li><li>varying compression levels</li><li>Decompression time</li></ul><p>And a lot&mldr;</p><p>For modern hardware, <code>zstd</code> seems to be the most suitable one. And I&rsquo;m going to use <code>zstd</code> a lot :)</p></article></div></main></body></html>